<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <!-- js library tabulator -->
    <link href="https://unpkg.com/tabulator-tables@4.9.3/dist/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.9.3/dist/js/tabulator.min.js"></script>
    <!-- js library pretty print json -->
    <link rel=stylesheet href=https://cdn.jsdelivr.net/npm/pretty-print-json@1.0/dist/pretty-print-json.css>
    <script src=https://cdn.jsdelivr.net/npm/pretty-print-json@1.0/dist/pretty-print-json.min.js></script>
    <title>Raw Record Preview</title>
    <!-- load js and css files-->
    <link rel=stylesheet type="text/css" href="styles.css" />
    <script type="text/javascript" src="script.js"></script>
    <!-- load split.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/split.js/1.6.0/split.min.js"></script>
</head>

<body>
    <!--header -->
    <div class="box">
        <div class="header">
            <span class="logo">Raw Record Preview</span>&nbsp;&nbsp;&nbsp;&nbsp;
            <span>id: </span>
            <input id="id_filter" size=40>
            <button id="bt_fillter" onclick="doIdFilter('id_filter')">submit</button>&nbsp;&nbsp;&nbsp;&nbsp; Records loaded:
            <span id="records_load">0</span>&nbsp;&nbsp;&nbsp;&nbsp; Total records:
            <span id="total_records">0</span>
        </div>
        <div class="content">
            <!-- Top -->
            <div id="records_table">asd</div>
            <!-- Bottom -->
            <div class="records" id="bottom">
                <div class="container">
                    <div class="container_child" id="left">
                        <span class="label">Raw record</span>
                        <pre id="records_show"></pre>
                    </div>
                    <div class="container_child" id="right">
                        <span class="label">iSample record</span>
                        <pre>iSample transformed record</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    //load records from server into tabulator
    var table = new Tabulator("#records_table", {
        layout: "fitColumns",
        height: 300,
        placeholder: "No data availble",
        ajaxURL: "https://mars.cyverse.org/thing/?offset=0&limit=1000&status=200",
        paginationDataSent: {
            "page": "offset",
            "size": "limit",
        },
        ajaxURLGenerator: function(url, config, params) {
            return url + `?offset=${params.offset}&limit=${params.limit}&status=200`;
        },
        ajaxProgressiveLoad: "scroll",
        paginationSize: 1000,
        ajaxParams: {
            key1: "id",
            keys: "tcreated"
        },
        columns: [{
            "title": "id",
            field: "id",
        }, {
            "title": "authority_id",
            field: "authority_id",
            width: 150
        }, {
            "title": "time created",
            field: "tcreated",
            width: 300
        }, {
            "title": "status",
            field: "resolved_status",
            width: 150
        }, {
            "title": "url",
            field: "resolved_url"
        }, {
            "title": "elapsed",
            field: "resolve_elapsed"
        }],
        ajaxResponse: Dataloaded,
        rowClick: rowClick,
        ajaxSorting: true,
        selectable: 1
    });

    Split(["#records_table", "#bottom"], {
        gutterSize: 30,
        direction: "vertical",
        sizes: [30, 70],
    });
    Split(["#left", "#right"], {
        gutterSize: 10,
    });
</script>

</html>